<!-- MHonArc v2.4.3 -->
<!--X-Subject: Re: A weakness in PGP signatures, and a suggested solution -->
<!--X-From-R13: Sevp [heenl <revpzNyar.pbz> -->
<!--X-Date: Thu, 18 Jan 1996 12:54:34 +0800 -->
<!--X-Message-Id: 199601180442.UAA15648@slack.lne.com -->
<!--X-Content-Type: text/plain -->
<!--X-Reference: 199601180344.WAA26221@charon.MIT.EDU -->
<!--X-Head-End-->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML//EN">
<HTML>
<HEAD>
<TITLE>Re: A weakness in PGP signatures, and a suggested solution</TITLE>
<LINK REV="made" HREF="mailto:ericm@lne.com">
</HEAD>
<BODY>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<HR>
[<A HREF="msg01054.html">Date Prev</A>][<A HREF="msg01059.html">Date Next</A>][<A HREF="msg01058.html">Thread Prev</A>][<A HREF="msg01059.html">Thread Next</A>][<A HREF="index.html#01051">Date Index</A>][<A HREF="threads.html#01051">Thread Index</A>]
<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<H1>Re: A weakness in PGP signatures, and a suggested solution</H1>
<HR>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<UL>
<LI><em>To</em>: <A HREF="mailto:warlord@ATHENA.MIT.EDU">warlord@ATHENA.MIT.EDU</A> (Derek Atkins)</LI>
<LI><em>Subject</em>: Re: A weakness in PGP signatures, and a suggested solution</LI>
<LI><em>From</em>: Eric Murray &lt;<A HREF="mailto:ericm@lne.com">ericm@lne.com</A>&gt;</LI>
<LI><em>Date</em>: Wed, 17 Jan 1996 20:42:28 -0800 (PST)</LI>
<LI><em>Cc</em>: <A HREF="mailto:dlv@bwalk.dm.com">dlv@bwalk.dm.com</A>, <A HREF="mailto:cypherpunks@toad.com">cypherpunks@toad.com</A></LI>
<LI><em>In-Reply-To</em>: &lt;<A HREF="msg01058.html">199601180344.WAA26221@charon.MIT.EDU</A>&gt; from "Derek Atkins" at Jan 17, 96 10:43:57 pm</LI>
<LI><em>Sender</em>: <A HREF="mailto:owner%2Dcypherpunks@toad.com">owner-cypherpunks@toad.com</A></LI>
</UL>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
<HR>
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<PRE>
Derek Atkins writes:
[Dr Dimitri writes:]
&gt; 
&gt; &gt; 2. When PGP verified the signature, it should have an option to look outside
&gt; &gt; the signed portion for RFC 822 headers and compare them to the signed copy
&gt; &gt; of he headers inside. If this is not in PGP, then then function would have to
&gt; &gt; be done by some non-portable wrapper.
&gt; &gt; (Of course, if your headers aren't RFC 822, you're out of luck.)
 
[..]
 
&gt; PGP really only looks at the contents between the BEGIN and END.  It
&gt; can't do anything else.  In fact, only the PGP Armor code even deals
&gt; with that.  By definition, PGP is a binary protocol and deal with
&gt; binary data objects.  So how can it look at any "RFC 822 Headers"?
&gt; There are no such animals in PGP.  It is perfectly legal to remove all
&gt; data before the BEGIN and all data after then END and feed the result
&gt; to PGP...
&gt; 
&gt; As I said, armor is a convenience to the user only.
&gt; 
&gt; PGP will not be modified in this way; it is the job of the mailer
&gt; (MUA) to do this sort of thing.  Sorry.

I agree.
PGP should be as generic as possible; making it "know" about RFC822
and mailers makes it less generic.

Your PGP-aware mail agent should add a line to the text to be
encrypted, consisting of a random number (hopefully very unguessable
and fairly random) and an RFC822 header:

X-PGP-nonce: b1de70694f5f0824f89cb3f09aece01d

and replicate that in the RFC822 envelope.
Put just the nonce value and not the header in the block to be
encrypted if you're concerned about assisting a known-plaintext attack.

The nonce can't be extracted from the PGP ciphertext unless the attacker
has the ability to crack PGP, in which case merely re-directing
PGP encrypted messages to different recipients is beneath them. :-)
It is small and is easily verified by the human looking at the message.
PGP, or more accurately the MUA, won't need to check it (although
that would be fairly easy to do).

But like Derek says, PGP shouldn't do it, the MUA should.

-- 
Eric Murray  ericm@lne.com  ericm@motorcycle.com  <A  HREF="http://www.lne.com/ericm">http://www.lne.com/ericm</A>
PGP keyid:E03F65E5 fingerprint:50 B0 A2 4C 7D 86 FC 03  92 E8 AC E6 7E 27 29 AF

</PRE>

<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
<HR>
<UL><LI><STRONG>Follow-Ups</STRONG>:
<UL>
<LI><STRONG><A NAME="01059" HREF="msg01059.html">Re: A weakness in PGP signatures, and a suggested solution</A></STRONG>
<UL><LI><EM>From:</EM> Derek Atkins &lt;warlord@ATHENA.MIT.EDU&gt;</LI></UL></LI>
</UL></LI></UL>
<!--X-Follow-Ups-End-->
<!--X-References-->
<UL><LI><STRONG>References</STRONG>:
<UL>
<LI><STRONG><A NAME="01058" HREF="msg01058.html">Re: A weakness in PGP signatures, and a suggested solution</A></STRONG>
<UL><LI><EM>From:</EM> Derek Atkins &lt;warlord@ATHENA.MIT.EDU&gt;</LI></UL></LI>
</UL></LI></UL>
<!--X-References-End-->
<!--X-BotPNI-->
<UL>
<LI>Prev by Date:
<STRONG><A HREF="msg01054.html">RE: Random Number Generators</A></STRONG>
</LI>
<LI>Next by Date:
<STRONG><A HREF="msg01059.html">Re: A weakness in PGP signatures, and a suggested solution</A></STRONG>
</LI>
<LI>Prev by thread:
<STRONG><A HREF="msg01058.html">Re: A weakness in PGP signatures, and a suggested solution</A></STRONG>
</LI>
<LI>Next by thread:
<STRONG><A HREF="msg01059.html">Re: A weakness in PGP signatures, and a suggested solution</A></STRONG>
</LI>
<LI>Index(es):
<UL>
<LI><A HREF="index.html#01051"><STRONG>Date</STRONG></A></LI>
<LI><A HREF="threads.html#01051"><STRONG>Thread</STRONG></A></LI>
</UL>
</LI>
</UL>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
</BODY>
</HTML>
