<!-- MHonArc v2.4.3 -->
<!--X-Subject: [ITAR/POLITICS] rsa&#45;in&#45;3&#45;lines&#45;of&#45;perl just shrunk!! -->
<!--X-From-R13: Oqnz Pnpx <nonNqpf.rk.np.hx> -->
<!--X-Date: Mon, 1 Apr 1996 14:48:35 +0800 -->
<!--X-Message-Id: 199603312332.AAA00930@adam.test.net -->
<!--X-Content-Type: text/plain -->
<!--X-Head-End-->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML//EN">
<HTML>
<HEAD>
<TITLE>[ITAR/POLITICS] rsa-in-3-lines-of-perl just shrunk!!</TITLE>
<LINK REV="made" HREF="mailto:aba@dcs.ex.ac.uk">
</HEAD>
<BODY>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<HR>
[<A HREF="msg00001.html">Date Prev</A>][<A HREF="msg00024.html">Date Next</A>][<A HREF="msg00001.html">Thread Prev</A>][<A HREF="msg00024.html">Thread Next</A>][<A HREF="index.html#00000">Date Index</A>][<A HREF="threads.html#00000">Thread Index</A>]
<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<H1>[ITAR/POLITICS] rsa-in-3-lines-of-perl just shrunk!!</H1>
<HR>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<UL>
<LI><em>To</em>: <A HREF="mailto:cypherpunks@toad.com">cypherpunks@toad.com</A></LI>
<LI><em>Subject</em>: [ITAR/POLITICS] rsa-in-3-lines-of-perl just shrunk!!</LI>
<LI><em>From</em>: Adam Back &lt;<A HREF="mailto:aba@dcs.ex.ac.uk">aba@dcs.ex.ac.uk</A>&gt;</LI>
<LI><em>Date</em>: Mon, 1 Apr 1996 00:32:55 +0100</LI>
<LI><em>Cc</em>: <A HREF="mailto:aba@dcs.ex.ac.uk">aba@dcs.ex.ac.uk</A></LI>
<LI><em>Sender</em>: <A HREF="mailto:owner%2Dcypherpunks@toad.com">owner-cypherpunks@toad.com</A></LI>
</UL>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
<HR>
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<PRE>

Sorry to contribute to the simply awesome noise to signal ratio here
lately (hopefully the subject tag should help those not interested in
politics), but...

[if you don't know what I'm talking about, see

	<A  HREF="http://www.dcs.ex.ac.uk/~aba/rsa/">http://www.dcs.ex.ac.uk/~aba/rsa/</A> 

for a combined perl hack and ITAR violation]

Due mainly to a couple of insights donated by someone who was
introduced to the code via a friends `munition' T-shirt... he started
the ball rolling again...

it shrunk from:

#!/bin/perl -s-- -export-a-crypto-system-sig -RSA-3-lines-PERL
$m=unpack(H.$w,$m."\0"x$w),$_=`echo "16do$w 2+4Oi0$d*-^1[d2%Sa
2/d0&lt;X+d*La1=z\U$n%0]SX$k"[$m*]\EszlXx++p|dc`,s/^.|\W//g,print
pack('H*',$_)while read(STDIN,$m,($w=2*$d-1+length($n)&amp;~1)/2)

to:

#!/bin/perl -sp0777i&lt;X+d*lMLa^*lN%0]dsXx++lMlN/dsM0&lt;j]dsj
$/=unpack('H*',$_);$_=`echo 16dio\U$k"SK$/SM$n\EsN0p[lN*1
lK[d2%Sa2/d0$^Ixp"|dc`;s/\W//g;$_=pack('H*',/((..)*)$/)

(Actually it's not quite as impressive as it might look at first
glance because the old version included the comment "-export-a-
crypto-system-sig -RSA-3-lines-PERL", so the new one should really be
compared against:

#!/bin/perl -s
$m=unpack(H.$w,$m."\0"x$w),$_=`echo "16do$w 2+4Oi0$d*-^1[d2%Sa
2/d0&lt;X+d*La1=z\U$n%0]SX$k"[$m*]\EszlXx++p|dc`,s/^.|\W//g,print
pack('H*',$_)while read(STDIN,$m,($w=2*$d-1+length($n)&amp;~1)/2)

)

but it's still a whole 31 bytes shorter, and it now really is in 3
lines of perl rather than cheating and not counting the #!/bin/perl
line.  (Several people took me to task on that one).

I won't consume list bandwidth describing exactly how the new one
works, and the arcane perl and dc hackery that went into it, as I have
described it all in excruciating detail on:

	<A  HREF="http://www.dcs.ex.ac.uk/~aba/rsa/story.html">http://www.dcs.ex.ac.uk/~aba/rsa/story.html</A>

I really wasn't expecting to see it shortened any further.

There goes all those T-shirts, outdated, my sincere apologies to
Richard White also, whose tattoo was featured in the April issue of
Wired (at least the UK edition, the US one too?),

Oh yeah, and if you can see any ways to shorten it, please tell me!
(Perl5 specifics not allowed, there is already a shorter p5 specific
version but it's got to be as portable as possible).

Adam

ps I now have a reasonable stock of T-shirts again after the prolonged
hiatus of my printer, who finally delivered the 2nd batch.
--
#!/bin/perl -sp0777i&lt;X+d*lMLa^*lN%0]dsXx++lMlN/dsM0&lt;j]dsj
$/=unpack('H*',$_);$_=`echo 16dio\U$k"SK$/SM$n\EsN0p[lN*1
lK[d2%Sa2/d0$^Ixp"|dc`;s/\W//g;$_=pack('H*',/((..)*)$/)

</PRE>

<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
<HR>
<!--X-Follow-Ups-End-->
<!--X-References-->
<!--X-References-End-->
<!--X-BotPNI-->
<UL>
<LI>Prev by Date:
<STRONG><A HREF="msg00001.html">Spy Dupe</A></STRONG>
</LI>
<LI>Next by Date:
<STRONG><A HREF="msg00024.html">New release of SFS available</A></STRONG>
</LI>
<LI>Prev by thread:
<STRONG><A HREF="msg00001.html">Spy Dupe</A></STRONG>
</LI>
<LI>Next by thread:
<STRONG><A HREF="msg00024.html">New release of SFS available</A></STRONG>
</LI>
<LI>Index(es):
<UL>
<LI><A HREF="index.html#00000"><STRONG>Date</STRONG></A></LI>
<LI><A HREF="threads.html#00000"><STRONG>Thread</STRONG></A></LI>
</UL>
</LI>
</UL>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
</BODY>
</HTML>
