<!-- MHonArc v2.4.3 -->
<!--X-Subject: Re: [Long] How to break Netscape's server key encryption -->
<!--X-From-R13: Xrss Irvafgrva <wfjNargfpncr.pbz> -->
<!--X-Date: Thu, 26 Sep 1996 06:44:10 +0800 -->
<!--X-Message-Id: 3249833B.3EEE@netscape.com -->
<!--X-Content-Type: text/plain -->
<!--X-Reference: 84366802803808@cs26.cs.auckland.ac.nz -->
<!--X-Head-End-->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML//EN">
<HTML>
<HEAD>
<TITLE>Re: [Long] How to break Netscape's server key encryption</TITLE>
<LINK REV="made" HREF="mailto:jsw@netscape.com">
</HEAD>
<BODY>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<HR>
[<A HREF="msg02241.html">Date Prev</A>][<A HREF="msg02262.html">Date Next</A>][<A HREF="msg02300.html">Thread Prev</A>][<A HREF="msg02262.html">Thread Next</A>][<A HREF="index.html#02216">Date Index</A>][<A HREF="threads.html#02216">Thread Index</A>]
<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<H1>Re: [Long] How to break Netscape's server key encryption</H1>
<HR>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<UL>
<LI><em>To</em>: <A HREF="mailto:pgut001@cs.auckland.ac.nz">pgut001@cs.auckland.ac.nz</A></LI>
<LI><em>Subject</em>: Re: [Long] How to break Netscape's server key encryption</LI>
<LI><em>From</em>: Jeff Weinstein &lt;<A HREF="mailto:jsw@netscape.com">jsw@netscape.com</A>&gt;</LI>
<LI><em>Date</em>: Wed, 25 Sep 1996 12:08:43 -0700</LI>
<LI><em>CC</em>: <A HREF="mailto:cypherpunks@toad.com">cypherpunks@toad.com</A></LI>
<LI><em>Organization</em>: Netscape Communications Corp.</LI>
<LI><em>References</em>: &lt;<A HREF="msg02300.html">84366802803808@cs26.cs.auckland.ac.nz</A>&gt;</LI>
<LI><em>Reply-To</em>: <A HREF="mailto:jsw@netscape.com">jsw@netscape.com</A></LI>
<LI><em>Sender</em>: <A HREF="mailto:owner%2Dcypherpunks@toad.com">owner-cypherpunks@toad.com</A></LI>
</UL>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
<HR>
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<PRE>
pgut001@cs.auckland.ac.nz wrote:
&gt; 
&gt; The Netscape server key format is very susceptible to both a dictionary attack
&gt; and to keystream recovery.  It uses the PKCS #8 format for private keys, which
&gt; provides a large amount of known plaintext at the start of the data, in
&gt; combination with RC4 without any form of IV or other preprocessing (even though
&gt; PKCS #8 recommends that PKCS #5 password-based encryption be used), which means
&gt; you can recover the first 100-odd bytes of key stream with a simple XOR (the
&gt; same stupid mistake Microsoft made with their .PWL files).  This means two
&gt; things:
&gt; 
&gt; 1. It's very simple to write a program to perform a dictionary attack on the
&gt;    server key (it took me about half an hour using cryptlib, and another half
&gt;    hour to rip the appropriate code out of cryptlib to create a standalone
&gt;    program).
&gt; 
&gt; 2. The recovered key stream from the encrypted server key can be used to
&gt;    decrypt any other resource encrypted with the server password, *without
&gt;    knowing the password*.  This is because there's enough known plaintext
&gt;    (ASN.1 objects, object identifiers, and public key components) at the start
&gt;    of the encrypted data to recover large quantities of key stream.

Peter,
  The attack you describe is indeed possible with the Netscape Commerce Server
1.x.  However current Netscape products, such as Navigator, Enterprise Server,
and FastTrack Server, have improved private key encryption that prevents
these types of attacks.  Note that the old key handling code is of the
same vintage as the random number seed code that was shown to be weak last
year (from before I got here).  I recognized this particular problem
quite some time ago, and fixed all of the products that were then in
development.

  If someone is running the old Commerce Server, and is not confident
that the file system of their server machine can not be accessed by
attackers, I would recommend that they upgrade to the FastTrack or
Enterprise servers.

	--Jeff

-- 
Jeff Weinstein - Electronic Munitions Specialist
Netscape Communication Corporation
jsw@netscape.com - <A  HREF="http://home.netscape.com/people/jsw">http://home.netscape.com/people/jsw</A>
Any opinions expressed above are mine.

</PRE>

<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
<HR>
<!--X-Follow-Ups-End-->
<!--X-References-->
<UL><LI><STRONG>References</STRONG>:
<UL>
<LI><STRONG><A NAME="02300" HREF="msg02300.html">[Long] How to break Netscape's server key encryption</A></STRONG>
<UL><LI><EM>From:</EM> pgut001@cs.auckland.ac.nz</LI></UL></LI>
</UL></LI></UL>
<!--X-References-End-->
<!--X-BotPNI-->
<UL>
<LI>Prev by Date:
<STRONG><A HREF="msg02241.html">Re: WHO IS MAKING A MOCKERY OF WHOM?</A></STRONG>
</LI>
<LI>Next by Date:
<STRONG><A HREF="msg02262.html">A periodic word of caution regarding Timothy C[unt] May</A></STRONG>
</LI>
<LI>Prev by thread:
<STRONG><A HREF="msg02300.html">[Long] How to break Netscape's server key encryption</A></STRONG>
</LI>
<LI>Next by thread:
<STRONG><A HREF="msg02262.html">A periodic word of caution regarding Timothy C[unt] May</A></STRONG>
</LI>
<LI>Index(es):
<UL>
<LI><A HREF="index.html#02216"><STRONG>Date</STRONG></A></LI>
<LI><A HREF="threads.html#02216"><STRONG>Thread</STRONG></A></LI>
</UL>
</LI>
</UL>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
</BODY>
</HTML>
