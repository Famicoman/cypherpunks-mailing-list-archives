<!-- MHonArc v2.4.3 -->
<!--X-Subject: Re: Security hole in premail -->
<!--X-From-R13: [vkznfgre <yhpvsreNquc.pbz> -->
<!--X-Date: Sat, 21 Dec 1996 20:50:41 &#45;0800 (PST) -->
<!--X-Message-Id: 199612220408.XAA03397@dhp.com -->
<!--X-Content-Type: text/plain -->
<!--X-Head-End-->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML//EN">
<HTML>
<HEAD>
<TITLE>Re: Security hole in premail</TITLE>
<LINK REV="made" HREF="mailto:lucifer@dhp.com">
</HEAD>
<BODY>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<HR>
[<A HREF="msg01469.html">Date Prev</A>][<A HREF="msg01478.html">Date Next</A>][<A HREF="msg01396.html">Thread Prev</A>][<A HREF="msg01382.html">Thread Next</A>][<A HREF="index.html#01475">Date Index</A>][<A HREF="threads.html#01475">Thread Index</A>]
<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<H1>Re: Security hole in premail</H1>
<HR>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<UL>
<LI><em>To</em>: <A HREF="mailto:cypherpunks@toad.com">cypherpunks@toad.com</A></LI>
<LI><em>Subject</em>: Re: Security hole in premail</LI>
<LI><em>From</em>: Mixmaster &lt;<A HREF="mailto:lucifer@dhp.com">lucifer@dhp.com</A>&gt;</LI>
<LI><em>Date</em>: Sat, 21 Dec 1996 23:08:22 -0500</LI>
<LI><em>Sender</em>: <A HREF="mailto:owner%2Dcypherpunks@toad.com">owner-cypherpunks@toad.com</A></LI>
</UL>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
<HR>
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<PRE>
On Fri, 20 Dec 1996, Mixmaster wrote:

&gt; *** premail.orig	Fri Dec 20 18:46:01 1996
&gt; --- premail	Fri Dec 20 18:55:54 1996
&gt; ***************
&gt; *** 3574,3579 ****
&gt; --- 3574,3582 ----
&gt;       }
&gt;       for ($triesleft = 2; !$done &amp;&amp; $triesleft; $triesleft--) {
&gt;   	$pass = &amp;getpass ($x);
&gt; + 	if(!-O $ps) {
&gt; + 		&amp;error ("Secrets file exists and is owned by another user\n");
&gt; + 	}
&gt;   	$status = &amp;decrypt_secrets ($ps_pgp, $ps, $pass);
&gt;   	if (!-s $ps) { unlink $ps; }
&gt;   	$done = (!$status &amp;&amp; -e $ps);

That patch doesn't work.  It will always return an error.  I have tested the
following patch and it does work as intended:

*** premail.orig	Wed Oct 30 22:25:10 1996
--- premail	Sat Dec 21 15:45:41 1996
***************
*** 3631,3636 ****
--- 3631,3639 ----
      $invoc .= ' &gt; '.$ps;
      $invoc .= ' 2&gt; '.$errfile;
      &amp;pdv ("Invoking PGP as $invoc\n");
+     if(-e $ps) {
+ 	&amp;error ("Premail secrets file already exists\n");
+     }
      $status = &amp;open_pgp ($invoc, $pass, '');
      $err = &amp;read_and_delete ($errfile);
      &amp;pdv ($err);

Sorry about the previous mistake.



</PRE>

<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
<HR>
<!--X-Follow-Ups-End-->
<!--X-References-->
<!--X-References-End-->
<!--X-BotPNI-->
<UL>
<LI>Prev by Date:
<STRONG><A HREF="msg01469.html">Re: "the world is half women, even though they're not on thec-punks 	 list"</A></STRONG>
</LI>
<LI>Next by Date:
<STRONG><A HREF="msg01478.html">Re: Ebonics</A></STRONG>
</LI>
<LI>Prev by thread:
<STRONG><A HREF="msg01396.html">Security hole in premail</A></STRONG>
</LI>
<LI>Next by thread:
<STRONG><A HREF="msg01382.html">Instruction Sets which are tough to emulate</A></STRONG>
</LI>
<LI>Index(es):
<UL>
<LI><A HREF="index.html#01475"><STRONG>Date</STRONG></A></LI>
<LI><A HREF="threads.html#01475"><STRONG>Thread</STRONG></A></LI>
</UL>
</LI>
</UL>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
</BODY>
</HTML>
