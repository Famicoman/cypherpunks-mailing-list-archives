<!-- MHonArc v2.4.3 -->
<!--X-Subject: Re: Attacks on remailers -->
<!--X-From-R13: pzrNryyvfha.fj.fgenghf.pbz (Qney Syyvfba) -->
<!--X-Date: Mon, 23 Aug 93 14:51:39 PDT -->
<!--X-Message-Id: 9308231749.ZM12733@ellisun.sw.stratus.com -->
<!--X-Content-Type: text/plain -->
<!--X-Reference: 9308230602.AA25533@jobe.shell.portal.com -->
<!--X-Head-End-->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML//EN">
<HTML>
<HEAD>
<TITLE>Re: Attacks on remailers</TITLE>
<LINK REV="made" HREF="mailto:cme@ellisun.sw.stratus.com">
</HEAD>
<BODY>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<HR>
[<A HREF="msg00665.html">Date Prev</A>][<A HREF="msg00670.html">Date Next</A>][<A HREF="msg00653.html">Thread Prev</A>][<A HREF="msg00670.html">Thread Next</A>][<A HREF="index.html#00669">Date Index</A>][<A HREF="threads.html#00669">Thread Index</A>]
<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<H1>Re: Attacks on remailers</H1>
<HR>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<UL>
<LI><em>To</em>: <A HREF="mailto:hfinney@shell.portal.com">hfinney@shell.portal.com</A>, <A HREF="mailto:cypherpunks@toad.com">cypherpunks@toad.com</A></LI>
<LI><em>Subject</em>: Re: Attacks on remailers</LI>
<LI><em>From</em>: <A HREF="mailto:cme@ellisun.sw.stratus.com">cme@ellisun.sw.stratus.com</A> (Carl Ellison)</LI>
<LI><em>Date</em>: Mon, 23 Aug 1993 17:49:28 -0400</LI>
<LI><em>In-Reply-To</em>: hfinney@shell.portal.com       "Attacks on remailers" (Aug 22, 11:02pm)</LI>
<LI><em>References</em>: &lt;<A HREF="msg00653.html">9308230602.AA25533@jobe.shell.portal.com</A>&gt;</LI>
</UL>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
<HR>
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<PRE>
On Aug 22, 11:02pm, hfinney@shell.portal.com wrote:
&gt; Subject: Attacks on remailers
&gt; Chaum, in his first paper on "Mixes" (anonymous remailers) described
&gt; protocols which were designed to resist several attacks.  (See the
&gt; February, 1981, Communications of the ACM, p. 84.)  These can
&gt; be understood by considering a series of attacks of increasing sophis-
&gt; tication, with corresponding responses.
&gt; 
&gt; Our opponent has as his goal to track a message through a chain of
&gt; remailers.
&gt; 
&gt; Attack 1: Just intercept the message from the sender, and look at the
&gt; commands of the form:
&gt; ::
&gt; Request-Remailing-To: first-remailer
&gt; ::
&gt; Request-Remailing-To: second-remailer
&gt; ::
&gt; Request-Remailing-To: final-destination
&gt; 
&gt; The final command shows where the message is finally going to go.
&gt; 
&gt; Response: Encrypt the messages.  Use "nesting", so that all that is
&gt; visible as each message leaves a remailer is the destination of the
&gt; next remailer.
&gt; 
&gt; Attack 2: Look at the mail logs on the system running the remailer to
&gt; see which message goes out from the remailer account shortly after each
&gt; message comes in.
&gt; 
&gt; Response: Run the remailer on a machine which does not keep mail logs,
&gt; or on a machine to which you can deny the attackers access.
&gt; 
&gt; Attack 3: Monitor the messages in real time as they flow into and out of
&gt; each remailer machine, again looking for the message which comes out
&gt; just after each incoming message.
&gt; 
&gt; Response: Batch up many messages which arrive over a period of time,
&gt; only sending them out at regular intervals or when a certain number have
&gt; accumulated.  Send them out in random order.  Alternatively, delay each
&gt; message by a random amount of time before the message goes out.  (This
&gt; response will also deal with the previous attack.)
&gt; 
&gt; Attack 4: Look at distinguishing features of the messages which are
&gt; preserved by the remailers, such as subject line or message size, to
&gt; match up incoming and outgoing messages within each batch.
&gt; 
&gt; Response: Do not retain any header fields through remailers, not even
&gt; subject.  Use an encryption mode in which messages are rounded up to
&gt; some standard size so that all messages appear to be the same size.
&gt; 
&gt; Attack 5: Record an incoming message to the remailer, and insert a copy
&gt; of it into the incoming message stream, so that the batch will have two
&gt; identical messages.  Look for two identical outgoing messages.  Remove
&gt; one.  This is the match to that incoming message.
&gt; 
&gt; Response: Check for duplicate incoming messages in the remailer, and
&gt; remove all but one copy of each duplicate.
&gt; 
&gt; Attack 6: Insert a duplicate message multiple times in separate batches.
&gt; Observe the outgoing batches and look for a pattern of destinations
&gt; which are correlated with those batches in which the incoming message
&gt; is inserted.
&gt; 
&gt; Response: Check for messages which have been duplicated from earlier
&gt; batches and remove them.  Include time/date stamps on incoming messages
&gt; with a time limit so that they are no good after a certain number of
&gt; days; this way the check for duplicates only has to go back that many
&gt; days.
&gt; 
&gt; Attack 7: Look at all messages coming out of the first remailer, and
&gt; follow them into their 2nd remailers; take all messages from those and
&gt; follow them on, and so on.  This will eventually lead to a number of
&gt; destinations, one of which must have been the destination of the original
&gt; message.  Over a period of time, look for correlations between destinations
&gt; and sources.
&gt; 
&gt; Response: Use large remailer chains of popular remailers.  With enough
&gt; mixing at each stage of the chain, the number of possible destinations
&gt; will become astronomically large, making correlations statistically
&gt; impossible.
&gt; 
&gt; Attack 8: Correlate messages being sent from person A with messages being
&gt; received a certain time later by person B.  Even without the ability to
&gt; track messages through the remailers this can show a communication pattern.
&gt; 
&gt; Response: Send dummy messages at regular intervals, which bounce through
&gt; the remailer network and then die.  When you have a real message to send,
&gt; replace one of the dummies with this.  The sender's traffic pattern is
&gt; then constant and no information can be gained from it.
&gt; 
&gt; Attack 9: Bribe or coerce one or more remailer operators into revealing
&gt; their keys, or into decrypting the desired messages.  Alternatively, run
&gt; many remailers, pretending to be dedicated to privacy, while secretly
&gt; gathering information on the messages.
&gt; 
&gt; Response: Use many remailers in a variety of geographical locations, so
&gt; that it is unlikely that all of them can be corrupted in this way.
&gt; 
&gt; These are all the attacks I can remember being implicitly considered in
&gt; Chaum's paper.  Other people who have ideas for attacks should mention
&gt; them so we can think of responses.
&gt; 
&gt; Chaum also discusses anonymous return addresses.  We have a simple form
&gt; of these enabled in our encrypting remailers.  The idea is to encrypt
&gt; a series of remailing requests for the path the message will follow,
&gt; with the last request directing the message to the user whose anonymous
&gt; address this is.
&gt; 
&gt; Some more attacks are possible in this case:
&gt; 
&gt; Attack 1A: Look at the message content as it passes through each remailer,
&gt; to correlate incoming and outgoing messages.
&gt; 
&gt; Response: Encrypt the message at each stage to prevent this matching.  This
&gt; raises the problem of how to determine the encryption key in such a way
&gt; that the final user can decrypt the message.  Chaum suggested including the
&gt; encryption key in the anonymous address (a different key at each stage
&gt; of the chain), so that the user can decrypt the message.  Eric Messick
&gt; has proposed letting the remailer choose the key, with a protocol for the
&gt; user to communicate again with the remailer to get the message decrypted.
&gt; 
&gt; Attack 1B: Send two different messages to the same return address with
&gt; different contents, and look for duplicate address blocks in the outgoing
&gt; batches.
&gt; 
&gt; Response: Apply some randomization to the address blocks at each stage so
&gt; that messages to the same address don't look identical.  (Chaum did not
&gt; give this solution, as he viewed the next attack as being essentially
&gt; unanswerable.)
&gt; 
&gt; Attack 1C: Send many addresses to the anonymous address, and look for a
&gt; destination which receives that many messages in a correlated fashion.
&gt; 
&gt; Response: Chaum's response is that the remailer must not accept more than
&gt; one message with a given anonymous return address, just as it must not
&gt; accept more than one copy of a message in the regular case.  This implies
&gt; that anonymous return addresses must be use-once to be truly secure.
&gt; 
&gt; This conclusion is uncomfortable, as the requirement that an address be
&gt; use-once will severely impair its usability.  But this attack appears
&gt; hard to avoid.
&gt; 
&gt; There is always the possibility of giving up on anonymous addresses in
&gt; the Chaumian sense, and instead using other ideas which have been
&gt; suggested here, such as posting to newsgroups, or message broadcast
&gt; pools.  All of these ideas have the problem that they expose everyone
&gt; in some group to all of the messages intended for every group member,
&gt; hence the number of messages will scale as the square of the number of
&gt; group members.  This will quickly become unmanageable for large groups,
&gt; therefore providing only a limited amount of anonymity.
&gt; 
&gt; It's also worth noting that our remailers are vulnerable to almost all
&gt; of these attacks; at best we are safe against two or three of them.
&gt; 
&gt; Hal Finney
&gt; hfinney@shell.portal.com
&gt;-- End of excerpt from hfinney@shell.portal.com



</PRE>

<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
<HR>
<!--X-Follow-Ups-End-->
<!--X-References-->
<UL><LI><STRONG>References</STRONG>:
<UL>
<LI><STRONG><A NAME="00653" HREF="msg00653.html">Attacks on remailers</A></STRONG>
<UL><LI><EM>From:</EM> hfinney@shell.portal.com</LI></UL></LI>
</UL></LI></UL>
<!--X-References-End-->
<!--X-BotPNI-->
<UL>
<LI>Prev by Date:
<STRONG><A HREF="msg00665.html">Chaum criticism</A></STRONG>
</LI>
<LI>Next by Date:
<STRONG><A HREF="msg00670.html">Re: Attacks on remailers</A></STRONG>
</LI>
<LI>Prev by thread:
<STRONG><A HREF="msg00653.html">Attacks on remailers</A></STRONG>
</LI>
<LI>Next by thread:
<STRONG><A HREF="msg00670.html">Re: Attacks on remailers</A></STRONG>
</LI>
<LI>Index(es):
<UL>
<LI><A HREF="index.html#00669"><STRONG>Date</STRONG></A></LI>
<LI><A HREF="threads.html#00669"><STRONG>Thread</STRONG></A></LI>
</UL>
</LI>
</UL>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
</BODY>
</HTML>
