<!-- MHonArc v2.4.3 -->
<!--X-Subject: Weak RSA keys? -->
<!--X-From-R13: uhturfNnu.pbz (Sevp Vhturf) -->
<!--X-Date: Thu, 7 Oct 93 14:35:56 PDT -->
<!--X-Message-Id: 9310072135.AA01702@ah.com -->
<!--X-Content-Type: text/plain -->
<!--X-Reference: 9310071956.AA02596@flammulated.owlnet.rice.edu -->
<!--X-Head-End-->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML//EN">
<HTML>
<HEAD>
<TITLE>Weak RSA keys?</TITLE>
<LINK REV="made" HREF="mailto:hughes@ah.com">
</HEAD>
<BODY>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<HR>
[<A HREF="msg00313.html">Date Prev</A>][<A HREF="msg00317.html">Date Next</A>][<A HREF="msg00319.html">Thread Prev</A>][<A HREF="msg00492.html">Thread Next</A>][<A HREF="index.html#00316">Date Index</A>][<A HREF="threads.html#00316">Thread Index</A>]
<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<H1>Weak RSA keys?</H1>
<HR>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<UL>
<LI><em>To</em>: <A HREF="mailto:cypherpunks@toad.com">cypherpunks@toad.com</A></LI>
<LI><em>Subject</em>: Weak RSA keys?</LI>
<LI><em>From</em>: <A HREF="mailto:hughes@ah.com">hughes@ah.com</A> (Eric Hughes)</LI>
<LI><em>Date</em>: Thu, 7 Oct 93 14:35:52 -0700</LI>
<LI><em>In-Reply-To</em>: Karl Lui Barrus's message of Thu, 7 Oct 1993 14:56:09 -0500 (CDT) &lt;<A HREF="msg00319.html">9310071956.AA02596@flammulated.owlnet.rice.edu</A>&gt;</LI>
</UL>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
<HR>
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<PRE>
Re: finding weak keys

The point with weak RSA keys is not that one can find other decryption
exponents deterministically given public information, but rather
probabilistically.  If gcd( p-1, q-1 ) is large with respect to pq,
then one can simply do a random search for these other exponents.

Greatest common divisors are quick to calculate, so there's no
practical problem with making sure that one does not generate weak
keys.

The rest of this message is a mathematical explanation of _why_ there
are at least two decryption exponents.

Warning: technical algebra follows.

Short answer: (Z/pqZ)^* is not a cyclic group, and therefore does not
contain elements of maximum order, i.e. of order (p-1)(q-1).
(Notation: the group above is the multiplicative group of numbers
modulo pq.)  The largest order of any element is lcm(p-1,q-1).

Longer answer: (Z/pqZ)^* is isomorphic to (Z/pZ)^* x (Z/qZ)^*.  The
isomorphism map is I: x mod pq |--&gt; ( x mod p, x mod q ).  Let f =
gcd(p-1,q-1) and F = lcm(p-1,q-1).  Define f_p = (q-1)/f and f_q =
(p-1)/f; both are integers.

Note that since Ff = (p-1)(q-1), F = (p-1)f_p = (q-1)f_q.

I( x^F mod pq )
	= ( x^F mod p, x^F mod q )
	= ( x^((p-1)f_p) mod p, x^((q-1)f_q) mod q )
	= ( (x^(f_p))^(p-1) mod p, (x^(f_q))^(q-1) mod q )
	= ( 1 mod p, 1 mod q )

The last step follows by Fermat's Little Theorem.  Since the
isomorphic image of x^F is (1,1), we conclude that x^F == 1 (mod pq),
for all x.  (To see this, use the Chinese Remainder Theorem.)

Since p and q are both odd, p-1 and q-1 are both even.  Thus their gcd
must be at least two.

Out of curiosity, does anybody here know how to calculate any
expectations for gcd(p-1,q-1) for, say, 2^n &lt; p &lt; q &lt; 2^(n+1) ?  I
don't know enough number theory myself.

Eric

</PRE>

<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
<HR>
<!--X-Follow-Ups-End-->
<!--X-References-->
<UL><LI><STRONG>References</STRONG>:
<UL>
<LI><STRONG><A NAME="00319" HREF="msg00319.html">Weak RSA keys?</A></STRONG>
<UL><LI><EM>From:</EM> Karl Lui Barrus &lt;klbarrus@owlnet.rice.edu&gt;</LI></UL></LI>
</UL></LI></UL>
<!--X-References-End-->
<!--X-BotPNI-->
<UL>
<LI>Prev by Date:
<STRONG><A HREF="msg00313.html">Good editorial in the Merc</A></STRONG>
</LI>
<LI>Next by Date:
<STRONG><A HREF="msg00317.html">Re: Standard Headers for Anonymous Remailers</A></STRONG>
</LI>
<LI>Prev by thread:
<STRONG><A HREF="msg00319.html">Weak RSA keys?</A></STRONG>
</LI>
<LI>Next by thread:
<STRONG><A HREF="msg00492.html">Re:  Weak RSA keys?</A></STRONG>
</LI>
<LI>Index(es):
<UL>
<LI><A HREF="index.html#00316"><STRONG>Date</STRONG></A></LI>
<LI><A HREF="threads.html#00316"><STRONG>Thread</STRONG></A></LI>
</UL>
</LI>
</UL>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
</BODY>
</HTML>
