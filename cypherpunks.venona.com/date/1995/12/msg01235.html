<!-- MHonArc v2.4.3 -->
<!--X-Subject: How to steal ecash (was: Questions/Comments on ecash protocol) -->
<!--X-From-R13: vntbyqorNpfpyho.hjngreybb.pn (Wna Ubyqoret) -->
<!--X-Date: Mon, 4 Dec 95 11:09:11 PST -->
<!--X-Message-Id: 49vgvh$i7a@calum.csclub.uwaterloo.ca -->
<!--X-Content-Type: text/plain -->
<!--X-Reference: 199512012222.OAA18230@netcom14.netcom.com -->
<!--X-Reference: 199512030127.RAA03496@cory.EECS.Berkeley.EDU -->
<!--X-Head-End-->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML//EN">
<HTML>
<HEAD>
<TITLE>How to steal ecash (was: Questions/Comments on ecash protocol)</TITLE>
<LINK REV="made" HREF="mailto:iagoldbe@csclub.uwaterloo.ca">
</HEAD>
<BODY>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<HR>
[<A HREF="msg01232.html">Date Prev</A>][<A HREF="msg01234.html">Date Next</A>][<A HREF="msg00176.html">Thread Prev</A>][<A HREF="msg00113.html">Thread Next</A>][<A HREF="index.html#01235">Date Index</A>][<A HREF="threads.html#01235">Thread Index</A>]
<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<H1>How to steal ecash (was: Questions/Comments on ecash protocol)</H1>
<HR>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<UL>
<LI><em>To</em>: <A HREF="mailto:cypherpunks@toad.com">cypherpunks@toad.com</A></LI>
<LI><em>Subject</em>: How to steal ecash (was: Questions/Comments on ecash protocol)</LI>
<LI><em>From</em>: <A HREF="mailto:iagoldbe@csclub.uwaterloo.ca">iagoldbe@csclub.uwaterloo.ca</A> (Ian Goldberg)</LI>
<LI><em>Date</em>: 4 Dec 1995 14:08:33 -0500</LI>
<LI><em>Distribution</em>: csc</LI>
<LI><em>Newsgroups</em>: csc.lists.cypherpunks</LI>
<LI><em>Organization</em>: University of Waterloo Computer Science Club</LI>
<LI><em>References</em>: &lt;<A HREF="msg00073.html">199512012222.OAA18230@netcom14.netcom.com</A>&gt; &lt;<A HREF="msg00159.html">199512030127.RAA03496@cory.EECS.Berkeley.EDU</A>&gt;</LI>
<LI><em>Reply-To</em>: <A HREF="mailto:iang@cs.berkeley.edu">iang@cs.berkeley.edu</A></LI>
<LI><em>Sender</em>: <A HREF="mailto:owner%2Dcypherpunks@toad.com">owner-cypherpunks@toad.com</A></LI>
</UL>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
<HR>
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<PRE>
In article &lt;<A HREF="msg00159.html">199512030127.RAA03496@cory.EECS.Berkeley.EDU</A>&gt;,
Ian Goldberg  &lt;iang@cory.EECS.Berkeley.EDU&gt; wrote:
&gt;Since the payer_code is not supposed to be sent around, how is it sent to
&gt;the bank in order to cancel a payment?  The document says "This allows him
&gt;to cancel the payment (deposit in his account)...", which seems to indicate
&gt;that a cancellation is just a deposit (made out to someone else), accompanied
&gt;by an appropriate payer_code.  It is important that an eavesdropper not
&gt;be able to ever see the payer_code that corresponds to a payment, or
&gt;else she could present both to the bank and say "cancel this payment",
&gt;and get the money "back".

After reading the responses to my questions/comments, it seems that, if
Charlie (the customer) wants to cancel a payment, his ecash client sends
a copy of the payment, including the payer_code field (which evidently was
not in the original payment), to the mint.  The mint accepts the payment
because the payer_code was supplied.  However, the payer_code is sent
_in the clear_.

Thus: How to steal ecash:

This method can be used by Mitch, an active eavesdropper, though all he really
needs to be able to do is selectively remove or delay packets in transit.

Mitch taps either his target, or, better yet, the mint, and watches for
deposits to the mint that have the payer_code filled in (a cancelled payment).
He delays that packet, and sends the identical deposit to the mint himself
(with his own userID in the userhdr, of course).  The mint, being unable
to know who withdrew the coin originally, has no reason to believe it wasn't
Mitch, and so happily deposits the money "back" in Mitch's account.
Mitch is then free to release the delay on the original packet, and
Charlie's deposit fails (as the coin has already been deposited).

So:  do I &lt;a href="<A  HREF="http://www.digicash.com/ecash/suggestion-box.html">http://www.digicash.com/ecash/suggestion-box.html</A>"&gt;win&lt;/a&gt;
anything?   :-)

Disclaimer: Don't do this.  Then again, is it illegal to copy ecash?  I doubt
  it's considered counterfeiting.  What about creating ecash out of thin air
  (say I had a magic factoring box (like a quantum computer (well, not yet)))?

   - Ian "IANAL, but IAA security-wise net.citizen..."

</PRE>

<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
<HR>
<!--X-Follow-Ups-End-->
<!--X-References-->
<UL><LI><STRONG>References</STRONG>:
<UL>
<LI><STRONG><A NAME="00073" HREF="msg00073.html">DigiCash releases protocol specs!</A></STRONG>
<UL><LI><EM>From:</EM> "Mark Twain Ecash Support" &lt;mtwain@netcom.com&gt;</LI></UL></LI>
<LI><STRONG><A NAME="00159" HREF="msg00159.html">Questions/Comments on ecash protocol</A></STRONG>
<UL><LI><EM>From:</EM> Ian Goldberg &lt;iang@cory.EECS.Berkeley.EDU&gt;</LI></UL></LI>
</UL></LI></UL>
<!--X-References-End-->
<!--X-BotPNI-->
<UL>
<LI>Prev by Date:
<STRONG><A HREF="msg01232.html">Re: INTERNET SECURITY RISKS FOR CONSUMERS OVERBLOWN</A></STRONG>
</LI>
<LI>Next by Date:
<STRONG><A HREF="msg01234.html">[POINTER:] Crypto Articles in Dr. Jobbs Journal</A></STRONG>
</LI>
<LI>Prev by thread:
<STRONG><A HREF="msg00176.html">Re: Questions/Comments on ecash protocol</A></STRONG>
</LI>
<LI>Next by thread:
<STRONG><A HREF="msg00113.html">Re: DigiCash releases protocol specs!</A></STRONG>
</LI>
<LI>Index(es):
<UL>
<LI><A HREF="index.html#01235"><STRONG>Date</STRONG></A></LI>
<LI><A HREF="threads.html#01235"><STRONG>Thread</STRONG></A></LI>
</UL>
</LI>
</UL>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
</BODY>
</HTML>
