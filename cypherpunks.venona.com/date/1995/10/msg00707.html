<!-- MHonArc v2.4.3 -->
<!--X-Subject: NEW Netscape RNG hole -->
<!--X-From-R13: na402976Nnaba.crarg.sv (DvatLreb) -->
<!--X-Date: Sun, 8 Oct 95 00:47:25 PDT -->
<!--X-Message-Id: 9510080732.AA14015@anon.penet.fi -->
<!--X-Content-Type: text/plain -->
<!--X-Head-End-->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML//EN">
<HTML>
<HEAD>
<TITLE>NEW Netscape RNG hole</TITLE>
<LINK REV="made" HREF="mailto:an402976@anon.penet.fi">
</HEAD>
<BODY>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<HR>
[<A HREF="msg00698.html">Date Prev</A>][<A HREF="msg00701.html">Date Next</A>][<A HREF="msg00714.html">Thread Prev</A>][<A HREF="msg00701.html">Thread Next</A>][<A HREF="index.html#00707">Date Index</A>][<A HREF="threads.html#00707">Thread Index</A>]
<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<H1>NEW Netscape RNG hole</H1>
<HR>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<UL>
<LI><em>To</em>: <A HREF="mailto:cypherpunks@toad.com">cypherpunks@toad.com</A></LI>
<LI><em>Subject</em>: NEW Netscape RNG hole</LI>
<LI><em>From</em>: <A HREF="mailto:an402976@anon.penet.fi">an402976@anon.penet.fi</A> (RingZero)</LI>
<LI><em>Date</em>: Sun,  8 Oct 1995 07:32:06 UTC</LI>
<LI><em>Organization</em>: Anonymous forwarding service</LI>
<LI><em>Reply-To</em>: <A HREF="mailto:an402976@anon.penet.fi">an402976@anon.penet.fi</A></LI>
<LI><em>Sender</em>: <A HREF="mailto:owner%2Dcypherpunks@toad.com">owner-cypherpunks@toad.com</A></LI>
</UL>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
<HR>
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<PRE>

Did anyone else notice a bug in the new, public Netscape
RNG code? It appears that on Windows builds, during the
RNG seeding, the function that hashes in file contents
(EnumSystemFiles) doesn't close a file handle (lFileHandle).
This doesn't hurt too badly on the client, but on a server,
leaking these resources is deadly.

I ran some experiments. It took a few thousand calls before
these open file handles forced not only the file content function
to fail, but also made OTHER calls quietly fail. With these calls
quietly failing, the RNG is significantly weakened. In my tests
on Windows NT, ALL of the following RNG functions failed:

* GetComputerName
* GetVolumeInformation
	volume Name,
	volume Serial Number,
	Maximum Filename Length
	Filesystem Flags
	Filesystem Name
* GetDiskFreeSpace
	SectorsPerCluster
	BytesPerSector
	Free Clusters
	Total Clusters
* subroutine for the inclusion of system files, both number of them &amp; contents
	ReadSystemFiles()
* subroutine used for other history file accesses
	SEC_FileForRNG(*filename)

How did this get past Netscape testers? Does anyone
know if this was fixed before Netscape shipped? Does
it rate a shirt, or does this mean  Jeff W. gets to shave his
head? I seem to remember him promising to shave it if we
could show a significant weakness in the new RNG code,
and since this does (IMO)...


On another note, has anyone noticed the 73 (!!!) or so
handles that are leaked by simply opening and closing
&amp;Options -&gt; &amp;Preferences... ? Looks like somebody had a
problem coding the tabbed dialog.


RingZero

--****ATTENTION****--****ATTENTION****--****ATTENTION****--***ATTENTION***
Your e-mail reply to this message WILL be *automatically* ANONYMIZED.
Please, report inappropriate use to                abuse@anon.penet.fi
For information (incl. non-anon reply) write to    help@anon.penet.fi
If you have any problems, address them to          admin@anon.penet.fi

</PRE>

<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
<HR>
<UL><LI><STRONG>Follow-Ups</STRONG>:
<UL>
<LI><STRONG><A NAME="00701" HREF="msg00701.html">Re: NEW Netscape RNG hole</A></STRONG>
<UL><LI><EM>From:</EM> Phil Karlton &lt;karlton@netscape.com&gt;</LI></UL></LI>
</UL></LI></UL>
<!--X-Follow-Ups-End-->
<!--X-References-->
<!--X-References-End-->
<!--X-BotPNI-->
<UL>
<LI>Prev by Date:
<STRONG><A HREF="msg00698.html">Certification Authorities in history.</A></STRONG>
</LI>
<LI>Next by Date:
<STRONG><A HREF="msg00701.html">Re: NEW Netscape RNG hole</A></STRONG>
</LI>
<LI>Prev by thread:
<STRONG><A HREF="msg00714.html">Re: Certification Authorities in history.</A></STRONG>
</LI>
<LI>Next by thread:
<STRONG><A HREF="msg00701.html">Re: NEW Netscape RNG hole</A></STRONG>
</LI>
<LI>Index(es):
<UL>
<LI><A HREF="index.html#00707"><STRONG>Date</STRONG></A></LI>
<LI><A HREF="threads.html#00707"><STRONG>Thread</STRONG></A></LI>
</UL>
</LI>
</UL>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
</BODY>
</HTML>
