<!-- MHonArc v2.4.3 -->
<!--X-Subject: Is my DH exchange secure? -->
<!--X-From-R13: uhturfNnu.pbz (Sevp Vhturf) -->
<!--X-Date: Sat, 21 May 94 07:05:14 PDT -->
<!--X-Message-Id: 9405211408.AA12666@ah.com -->
<!--X-Content-Type: text/plain -->
<!--X-Reference: 199405210512.WAA04068@mail.netcom.com -->
<!--X-Head-End-->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML//EN">
<HTML>
<HEAD>
<TITLE>Is my DH exchange secure?</TITLE>
<LINK REV="made" HREF="mailto:hughes@ah.com">
</HEAD>
<BODY>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<HR>
[<A HREF="msg01237.html">Date Prev</A>][<A HREF="msg01236.html">Date Next</A>][<A HREF="msg01231.html">Thread Prev</A>][<A HREF="msg01236.html">Thread Next</A>][<A HREF="index.html#01235">Date Index</A>][<A HREF="threads.html#01235">Thread Index</A>]
<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<H1>Is my DH exchange secure?</H1>
<HR>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<UL>
<LI><em>To</em>: <A HREF="mailto:cypherpunks@toad.com">cypherpunks@toad.com</A></LI>
<LI><em>Subject</em>: Is my DH exchange secure?</LI>
<LI><em>From</em>: <A HREF="mailto:hughes@ah.com">hughes@ah.com</A> (Eric Hughes)</LI>
<LI><em>Date</em>: Sat, 21 May 94 07:08:59 -0700</LI>
<LI><em>In-Reply-To</em>: catalyst-remailer@netcom.com's message of Fri, 20 May 1994 22:12:14 -0700 &lt;<A HREF="msg01231.html">199405210512.WAA04068@mail.netcom.com</A>&gt;</LI>
<LI><em>Sender</em>: <A HREF="mailto:owner%2Dcypherpunks@toad.com">owner-cypherpunks@toad.com</A></LI>
</UL>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
<HR>
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<PRE>
[Please don't quote entire messages.  It's a good way to make sure
your words afterwards get read by far fewer people.]

   The one precaution I did not take is: (from discussion above)

[looking for number of small order]

   Does the careful choosing of n and g eliminate this problem, or do I need
   to modify my Diffie-Hellman code to check g^a for short order? How do you
   check a number for short order?

If you wish to use generators mod p, proper choice of the prime will
minimize the problem; the generator has nothing to do with it.  All
generators are symmetric, or, more precisely, the automorphism group
takes each generator to every other.  Picking the prime p so that
p=2q+1 and q prime will reduce the number of elements with small order
to 2, namely 1 and -1.

In the more general case, let p=kq+1, where q is the large prime
factor of p-1 necessary for security.  Now the order of an element x
must divide p-1, so if it's not of order q or larger, i.e. safe, then
it must be of order k.  So calculate x^k (mod p) and see if it's equal
to 1.  If it is, then x has small order.

On the other hand, the tests for small order can be minimized by using
a generator of the subgroup of size q inside the group mod p, rather
than a generator of the full group.  Let p=kq+1 and let g be a
generator of Z/pZ (notation for the group of integers modulo p).  Then
g^k has order q in Z/pZ.  Since g generates the group, kq is the
smallest positive integer t such that g^t = 1 (mod p).  g^(kq) =
(g^k)^q, so g^k has order q.

Now if you use h=g^k as the base for the D-H exchange, the only h^x
with small order happens when x=0.  One can simply make the range of
the random numbers from 1 to q-1.  Because h has order q, and since q
is prime, every h^x except x=0 will also have order q.  Therefore
there are no "bad" values for x.  They have been removed by
construction in advance.

Eric





</PRE>

<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
<HR>
<!--X-Follow-Ups-End-->
<!--X-References-->
<UL><LI><STRONG>References</STRONG>:
<UL>
<LI><STRONG><A NAME="01231" HREF="msg01231.html">Is my DH exchange secure?</A></STRONG>
<UL><LI><EM>From:</EM> catalyst-remailer@netcom.com</LI></UL></LI>
</UL></LI></UL>
<!--X-References-End-->
<!--X-BotPNI-->
<UL>
<LI>Prev by Date:
<STRONG><A HREF="msg01237.html">Digital signature standard</A></STRONG>
</LI>
<LI>Next by Date:
<STRONG><A HREF="msg01236.html">Re:  Is my DH exchange secure?</A></STRONG>
</LI>
<LI>Prev by thread:
<STRONG><A HREF="msg01231.html">Is my DH exchange secure?</A></STRONG>
</LI>
<LI>Next by thread:
<STRONG><A HREF="msg01236.html">Re:  Is my DH exchange secure?</A></STRONG>
</LI>
<LI>Index(es):
<UL>
<LI><A HREF="index.html#01235"><STRONG>Date</STRONG></A></LI>
<LI><A HREF="threads.html#01235"><STRONG>Thread</STRONG></A></LI>
</UL>
</LI>
</UL>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
</BODY>
</HTML>
