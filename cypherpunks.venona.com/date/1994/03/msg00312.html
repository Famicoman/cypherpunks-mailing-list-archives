<!-- MHonArc v2.4.3 -->
<!--X-Subject: Re: Stealth PGP -->
<!--X-From-R13: [nggurj X Uuvb <zt5a+Nnaqerj.pzh.rqh> -->
<!--X-Date: Sun, 6 Mar 94 10:48:27 PST -->
<!--X-Message-Id: MhSWI=m00awH0EYEcH@andrew.cmu.edu -->
<!--X-Content-Type: text/plain -->
<!--X-Head-End-->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML//EN">
<HTML>
<HEAD>
<TITLE>Re: Stealth PGP</TITLE>
<LINK REV="made" HREF="mailto:mg5n+@andrew.cmu.edu">
</HEAD>
<BODY>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<HR>
[<A HREF="msg00311.html">Date Prev</A>][<A HREF="msg00313.html">Date Next</A>][<A HREF="msg00300.html">Thread Prev</A>][<A HREF="msg00297.html">Thread Next</A>][<A HREF="index.html#00312">Date Index</A>][<A HREF="threads.html#00312">Thread Index</A>]
<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<H1>Re: Stealth PGP</H1>
<HR>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<UL>
<LI><em>To</em>: <A HREF="mailto:cypherpunks@toad.com">cypherpunks@toad.com</A></LI>
<LI><em>Subject</em>: Re: Stealth PGP</LI>
<LI><em>From</em>: Matthew J Ghio &lt;<A HREF="mailto:mg5n%2B@andrew.cmu.edu">mg5n+@andrew.cmu.edu</A>&gt;</LI>
<LI><em>Date</em>: Sun,  6 Mar 1994 13:46:35 -0500 (EST)</LI>
<LI><em>Sender</em>: <A HREF="mailto:owner%2Dcypherpunks@toad.com">owner-cypherpunks@toad.com</A></LI>
</UL>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
<HR>
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<PRE>
There are actually several clever ways that you can get around the
problem with the RSA encrypted data being less than the modulus.  The
simplest is to encrypt it more than once.
Suppose you have a modulus m of legnth n.  You then create a block of
data to encrypt, b, of legnth n. If b is less than m, encrypt it with
RSA.  If not, don't encrypt it.  Then take 2^n-b-1 (which, btw, is the
same as xoring b with all one-bits).  If that result is less than m,
encrypt it with RSA.  Since m is greater than half of 2^n (it must be,
otherwise it would be less than legnth n), all possible plaintexts will
be encrypted at least once with RSA, some twice.  This does leave a
somewhat uneven distribution of values when comparing plaintext and
ciphertext (which can be minimized by more encryptions), but that only
shows up when and if the message is decrypted; as long as you use random
padding properly before encrypting, the encrypted data will look
completely random.

My ideal "Stealth-PGP" would work something like this: Take a file,
encrypt it with a random session key, prepend the session key to the
file, encrypt the first n bytes (which include the session key and part
of the encrypted data) with RSA if it's less than m, XOR it (reverse all
bits), and then encrypt with RSA if that's less than m.

Actually, putting the data inside the RSA might not be a good idea, it
would not work well for small files unless you added a legnth byte. 
Maybe the RSA part could just be filled with random padding...

</PRE>

<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
<HR>
<!--X-Follow-Ups-End-->
<!--X-References-->
<!--X-References-End-->
<!--X-BotPNI-->
<UL>
<LI>Prev by Date:
<STRONG><A HREF="msg00311.html">Re: Update on user-level hack to do telnet encryption posted recently</A></STRONG>
</LI>
<LI>Next by Date:
<STRONG><A HREF="msg00313.html">Time Article on Clipper</A></STRONG>
</LI>
<LI>Prev by thread:
<STRONG><A HREF="msg00300.html">Stealth PGP</A></STRONG>
</LI>
<LI>Next by thread:
<STRONG><A HREF="msg00297.html">Re: some technical steganography</A></STRONG>
</LI>
<LI>Index(es):
<UL>
<LI><A HREF="index.html#00312"><STRONG>Date</STRONG></A></LI>
<LI><A HREF="threads.html#00312"><STRONG>Thread</STRONG></A></LI>
</UL>
</LI>
</UL>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
</BODY>
</HTML>
