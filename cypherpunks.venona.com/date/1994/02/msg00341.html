<!-- MHonArc v2.4.3 -->
<!--X-Subject: Magic Money vulnerabilities? -->
<!--X-From-R13: abobqlNfuryy.cbegny.pbz -->
<!--X-Date: Sun, 6 Feb 94 00:10:50 PST -->
<!--X-Message-Id: 199402060810.AAA25213@jobe.shell.portal.com -->
<!--X-Content-Type: text/plain -->
<!--X-Head-End-->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML//EN">
<HTML>
<HEAD>
<TITLE>Magic Money vulnerabilities?</TITLE>
<LINK REV="made" HREF="mailto:nobody@shell.portal.com">
</HEAD>
<BODY>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<HR>
[<A HREF="msg00340.html">Date Prev</A>][<A HREF="msg00342.html">Date Next</A>][<A HREF="msg00338.html">Thread Prev</A>][<A HREF="msg00344.html">Thread Next</A>][<A HREF="index.html#00341">Date Index</A>][<A HREF="threads.html#00341">Thread Index</A>]
<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<H1>Magic Money vulnerabilities?</H1>
<HR>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<UL>
<LI><em>To</em>: <A HREF="mailto:cypherpunks@toad.com">cypherpunks@toad.com</A></LI>
<LI><em>Subject</em>: Magic Money vulnerabilities?</LI>
<LI><em>From</em>: <A HREF="mailto:nobody@shell.portal.com">nobody@shell.portal.com</A></LI>
<LI><em>Date</em>: Sun, 6 Feb 1994 00:10:21 -0800</LI>
<LI><em>Comments</em>: This message is NOT from the person listed in the Fromline.  It is from an automated software remailing service operating atthat address.  Please report problem mail to &lt;hfinney@shell.portal.com&gt;.</LI>
</UL>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
<HR>
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<PRE>
-----BEGIN PGP SIGNED MESSAGE-----

People have mentioned possible attacks against Magic Money.

I don't think it is possible to send the server a value to sign which
would reveal the server's secret key. The server signs your message x by
raising x to the power d. If you know x^d and x, finding d would seem to be
a discrete-logarithm problem, which is just as intractible as factoring.
Can a small or otherwise rigged x help you to find d? If so, participating
in any blind signature protocol is very dangerous, but I don't think that
you can find d this way.

wcs@anchor.ho.att.com wrote: (some deleted) 

(attack 1)

&gt;One security hole in online digicash systems of the Chaum variety is
&gt;that you _do_ need to make sure the money is only transmitted in
&gt;encrypted forms not susceptible to playback attacks.

&gt;If Eve can read the cash either before Bob gets it or before Bob's
&gt;message gets from his fast LAN across the slow part of the net
&gt;to the bank, then she can occasionally spend it before Bob can.

(attack 2)

&gt;If Eve stomps on the Account-number bits, even though she can't
&gt;break the encryption to substitute her account number for Bob's,
&gt;she can substitute a random account number for Bob's.
&gt;This acts as a denial-of-service attack against Bob.

&gt;As a defense, either the message has to contain signatures or at least
&gt;MACs for validation, and be rejected if invalid, or the format
&gt;needs to make it impossible to find the account number field
&gt;or to modify it without trashing the cash as well.

Magic Money is not susceptible to the first (intercept) attack, because
the coins are encrypted with the server's public key. The reply is also
encrypted with a response key sent to the server inside the encrypted
packet. The server signs its responses, so you couldn't send someone some
bogus coins and then fake the server's response to fool the person into
believing that the coins were good.

Magic Money has no account numbers; the server just exchanges old coins 
for new coins immediately. A version of the second attack is a problem. The
message from the user to the server has no authentication. It is just an
encrypted PGP message to the server. There is an RSA packet and an IDEA
packet, and the data is directly inside the IDEA packet. 

If you were to dearmor the message and garble something near the end, then 
re-armor it, the server would bounce the garbled coins with a bad signature. 
Some of the first coins would already have been cancelled, and their value 
would be lost. To prevent this, the next version will MD5 the data packet 
before encrypting it, and include the MD5 value. This will be checked, and 
if it is bad, the message will be thrown out before processing any of the 
coins. This is not a pressing problem. Who would go to all the trouble to
make a remailer detect and corrupt certain messages? The person doing the
corrupting would not have anything to gain.

A while ago I read of a program in alpha-test called Nautilus. This was
specifically designed to compress speech for modem transmission. The author
said that the beta, when it was ready, would be Copylefted. PGP Tools, if
combined with Nautilus, has everything you need to do a secure phone. With
the Clipper push, we need one badly, and now. It should use PGP keys for
authentication, but either DH or a one-shot RSA key for key exchange. That
way they can't record the session and demand your key later, as they could
if you used your regular PGP key for the key exchange.

                                             Pr0duct Cypher


-----BEGIN PGP SIGNATURE-----
Version: 2.3a

iQCVAgUBLVSdtMGoFIWXVYodAQHC9AQApMjaIF2+h0k6Zb2YSwjkFL1/zAgCXJU+
Dm+kS0us9kusKMc2wr2pc4cEzQow9apM/Od2CisXAaRtHZNUyE8tN3mYWEPxAdcd
6qG03ZekvTqQB+do2HBGRAH3KXGscPIDCyjuh9iIKp9bB7/GWLNoAYm7fPjxpIYz
gnWTuRyBme4=
=wOox
-----END PGP SIGNATURE-----

</PRE>

<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
<HR>
<!--X-Follow-Ups-End-->
<!--X-References-->
<!--X-References-End-->
<!--X-BotPNI-->
<UL>
<LI>Prev by Date:
<STRONG><A HREF="msg00340.html">Re: archiving on inet</A></STRONG>
</LI>
<LI>Next by Date:
<STRONG><A HREF="msg00342.html">Re: archiving on inet</A></STRONG>
</LI>
<LI>Prev by thread:
<STRONG><A HREF="msg00338.html">Magic Money Update</A></STRONG>
</LI>
<LI>Next by thread:
<STRONG><A HREF="msg00344.html">Government Policy makes Internet breakins easier</A></STRONG>
</LI>
<LI>Index(es):
<UL>
<LI><A HREF="index.html#00341"><STRONG>Date</STRONG></A></LI>
<LI><A HREF="threads.html#00341"><STRONG>Thread</STRONG></A></LI>
</UL>
</LI>
</UL>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
</BODY>
</HTML>
