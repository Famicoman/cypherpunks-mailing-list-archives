<!-- MHonArc v2.4.3 -->
<!--X-Subject: peasant_multiply question -->
<!--X-From-R13: sareqNfzqf.pbz (Thgher@req Egrir Ivgunz) -->
<!--X-Date: Tue, 8 Dec 92 09:53:58 PST -->
<!--X-Message-Id: 9212081715.AA26885@smds.com -->
<!--X-Content-Type: text/plain -->
<!--X-Head-End-->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML//EN">
<HTML>
<HEAD>
<TITLE>peasant_multiply question</TITLE>
<LINK REV="made" HREF="mailto:fnerd@smds.com">
</HEAD>
<BODY>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<HR>
[<A HREF="msg00082.html">Date Prev</A>][<A HREF="msg00085.html">Date Next</A>][<A HREF="msg00089.html">Thread Prev</A>][<A HREF="msg00084.html">Thread Next</A>][<A HREF="index.html#00083">Date Index</A>][<A HREF="threads.html#00083">Thread Index</A>]
<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<H1>peasant_multiply question</H1>
<HR>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<UL>
<LI><em>To</em>: <A HREF="mailto:cypherpunks@toad.com">cypherpunks@toad.com</A></LI>
<LI><em>Subject</em>: peasant_multiply question</LI>
<LI><em>From</em>: <A HREF="mailto:fnerd@smds.com">fnerd@smds.com</A> (FutureNerd Steve Witham)</LI>
<LI><em>Date</em>: Tue, 8 Dec 1992 13:26:56 -0800</LI>
<LI><em>Sender</em>: <A HREF="mailto:fnerd@192.9.200.3">fnerd@192.9.200.3</A></LI>
</UL>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
<HR>
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<PRE>
Folks--

I got out my copy of the original RSA paper, and I'm comparing it to the
PGP 2.0 code.  I have a question about the peasant_modmult routine (the
simplest modmult in PGP).  Here's pseudocode of what I think it's doing:

    /* Inputs: modulus, multiplier, multiplicand */
    /* Output: prod */

    prod = 0;
    set sniffer to most significant bit of multiplier;
    nbits = number of significant bits in multiplier;

    while( nbits-- )
        {
        shift prod left 1;
        prod = prod - modulus;
        if( the bit of the multiplier being sniffed = 1 )
            {
            prod = prod + multiplicand;
            prod = prod - modulus;
            }
        move the sniffer to the next bit of the multiplier;
        }

My question is (assuming I'm understanding the code right), how can it
work subtracting modulus unconditionally all the time?  Won't it make
prod negative sometimes, and then keep multiplying the negative number
by two until it overflows?   Isn't that a problem??

-fnerd
quote me
fnerd@smds.com (FutureNerd Steve Witham)


</PRE>

<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
<HR>
<!--X-Follow-Ups-End-->
<!--X-References-->
<!--X-References-End-->
<!--X-BotPNI-->
<UL>
<LI>Prev by Date:
<STRONG><A HREF="msg00082.html">Captain Midnight returns?</A></STRONG>
</LI>
<LI>Next by Date:
<STRONG><A HREF="msg00085.html">Re: PGP questions</A></STRONG>
</LI>
<LI>Prev by thread:
<STRONG><A HREF="msg00089.html">No more PGP keys without signatures, please!</A></STRONG>
</LI>
<LI>Next by thread:
<STRONG><A HREF="msg00084.html">PGP key generation</A></STRONG>
</LI>
<LI>Index(es):
<UL>
<LI><A HREF="index.html#00083"><STRONG>Date</STRONG></A></LI>
<LI><A HREF="threads.html#00083"><STRONG>Thread</STRONG></A></LI>
</UL>
</LI>
</UL>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
</BODY>
</HTML>
